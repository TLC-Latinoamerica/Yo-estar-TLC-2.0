<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Yo estar√© en TLC 2.0</title>
<style>
  body {
    display: flex;
    justify-content: center;
    align-items: center;
    background: #f0f0f0;
    margin: 0;
    padding: 20px;
    font-family: sans-serif;
    flex-direction: column;
  }
  .contenedor {
    position: relative;
    width: 100%;
    max-width: 900px;
    aspect-ratio: 900 / 1125;
    background: url("Yo-estare-en-TLC-2.0.png") no-repeat center/contain;
  }
  #canvas {
    width: 100%;
    height: 100%;
    display: block;
  }
  .controles {
    margin-top: 20px;
    text-align: center;
  }
  input[type="file"] {
    display: inline-block;
    padding: 10px 15px;
    background: #ff7bac;
    color: white;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    font-size: 14px;
  }
  input[type="file"]::file-selector-button {
    background: #ff4b7d;
    border: none;
    color: white;
    padding: 10px 15px;
    border-radius: 10px;
    cursor: pointer;
  }
  button {
    margin-left: 10px;
    padding: 10px 15px;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    font-size: 14px;
    background: #ff4b7d;
    color: white;
  }
</style>
</head>
<body>

<div class="contenedor">
  <canvas id="canvas" width="900" height="1125"></canvas>
</div>

<div class="controles">
  <label for="upload">üì∑ Subir foto</label>
  <input type="file" id="upload" accept="image/*">
  <button id="download">‚¨áÔ∏è Descargar</button>
</div>

<script>
  const canvas = document.getElementById("canvas");
  const ctx = canvas.getContext("2d");
  const plantilla = new Image();
  plantilla.src = "Yo-estare-en-TLC-2.0.png";

  const upload = document.getElementById("upload");
  const download = document.getElementById("download");

  let foto = null;

  // dibuja plantilla base
  plantilla.onload = () => {
    ctx.drawImage(plantilla, 0, 0, canvas.width, canvas.height);
  };

  upload.addEventListener("change", e => {
    const file = e.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = ev => {
      foto = new Image();
      foto.onload = () => {
        dibujar();
      };
      foto.src = ev.target.result;
    };
    reader.readAsDataURL(file);
  });

  function dibujar() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // plantilla fondo
    ctx.drawImage(plantilla, 0, 0, canvas.width, canvas.height);

    if (foto) {
      // c√≠rculo de recorte
      const cx = 450;  // centro en x
      const cy = 319;  // centro en y
      const radio = 220;

      ctx.save();
      ctx.beginPath();
      ctx.arc(cx, cy, radio, 0, Math.PI * 2, true);
      ctx.closePath();
      ctx.clip();

      // Escalar la foto al ancho del c√≠rculo
      const escala = (radio * 2) / foto.width;
      const newW = foto.width * escala;
      const newH = foto.height * escala;

      // Alinear desde arriba
      const x = cx - newW / 2;
      const y = cy - radio;

      ctx.drawImage(foto, x, y, newW, newH);
      ctx.restore();
    }

    // plantilla encima (para respetar borde del marco)
    ctx.drawImage(plantilla, 0, 0, canvas.width, canvas.height);
  }

  download.addEventListener("click", () => {
    const link = document.createElement("a");
    link.download = "Yo-estare-en-TLC-2.0.png";
    link.href = canvas.toDataURL("image/png");
    link.click();
  });
</script>

</body>
</html>
